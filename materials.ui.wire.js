/* materials.ui.wire.js v1.6 */ (function(){const log=(...a)=>console.log('[mat-ui-wire v1.6]',...a);const warn=(...a)=>console.warn('[mat-ui-wire v1.6]',...a);const W=window;let attached=false;async function ensurePersistReady(){if(!W.__LM_MAT_PERSIST__){warn('persist module missing');return false;}try{await W.__LM_MAT_PERSIST__.ensure();return true;}catch(e){warn('ensure failed',e);return false;}}function wire(){if(attached) return;const sel=document.querySelector('#pm-material');const rng=document.querySelector('#pm-opacity-range');const ds=document.querySelector('#pm-double-sided');const un=document.querySelector('#pm-unlit-like');if(!sel||!rng){warn('UI parts missing',{sel:!!sel,rng:!!rng,ds:!!ds,un:!!un});return;}let t;const handler=async()=>{const ok=await ensurePersistReady();if(!ok) return;const key=sel.value||sel.selectedOptions?.[0]?.value||'';if(!key) return;const payload={materialKey:key,opacity:parseFloat(rng.value),doubleSided:!!ds?.checked,unlitLike:!!un?.checked};await W.__LM_MAT_PERSIST__.upsert(payload).catch(e=>warn('persist failed',e));};const debounced=()=>{clearTimeout(t);t=setTimeout(handler,150);};rng.addEventListener('input',debounced,{passive:true});rng.addEventListener('change',debounced,{passive:true});rng.addEventListener('pointerup',debounced,{passive:true});sel.addEventListener('change',handler,{passive:true});ds?.addEventListener('change',handler,{passive:true});un?.addEventListener('change',handler,{passive:true});attached=true;log('wired');}wire();window.addEventListener('lm:mat-ui-ready',wire,{once:false});})();