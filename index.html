<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>LociMyu v6.6</title>
  <link rel="icon" href="./favicon.ico">
  <style>
    html,body{height:100%;margin:0;background:#0f0f13;color:#ddd;font:14px/1.4 system-ui,Segoe UI,Roboto,Helvetica,Arial}
    #app{display:grid;grid-template-columns:1fr 380px;grid-template-rows:100vh;gap:0}
    #stage{position:relative;background:#101014}
    #spinner{position:absolute;inset:0;display:grid;place-items:center;color:#ddd}
    #leader{position:absolute;inset:0;pointer-events:none}
    aside#panel{background:#14141a;border-left:1px solid #222;display:flex;flex-direction:column;min-width:300px}
    header#topbar{display:flex;align-items:center;gap:.5rem;padding:.5rem .75rem;border-bottom:1px solid #222}
    .btn{padding:.35rem .6rem;border:1px solid #444;border-radius:.5rem;background:#1a1a22;color:#ddd;cursor:pointer}
    .muted{color:#888}
    #tabs{display:flex;border-bottom:1px solid #222}
    .tab{flex:1;text-align:center;padding:.5rem;cursor:pointer;border-right:1px solid #222;background:#16161d}
    .tab.active{background:#1c1c26;font-weight:600}
    .pane{display:none;padding:.75rem .75rem;overflow:auto}
    .pane.active{display:block}
    .row{display:flex;align-items:center;gap:.5rem;margin:.25rem 0}
    .col{display:flex;flex-direction:column;gap:.25rem}
    .palette{display:flex;gap:.35rem;flex-wrap:wrap}
    .sw{width:24px;height:24px;border-radius:999px;border:2px solid #0003;cursor:pointer;box-shadow:0 0 0 2px #222}
    .sw.active{outline:2px solid #fff6}
    .ftoggles{display:flex;gap:.5rem;margin-left:.5rem}
    .ftoggles label{display:inline-flex;align-items:center;gap:.35rem;font-size:12px;color:#bbb;user-select:none}
    .dot{display:inline-block;width:12px;height:12px;border-radius:50%;border:1px solid rgba(0,0,0,.35)}
    @media (max-width:960px){#app{grid-template-columns:1fr}aside#panel{position:fixed;inset:auto 0 0 0;height:50vh;transform:translateY(calc(50vh - 42px));transition:.25s;box-shadow:0 -8px 24px rgba(0,0,0,.35)}
      aside#panel.expanded{transform:translateY(0)}}
  </style>

  <!-- three.js by import map (ESM) -->
  <script type="importmap">
  { "imports": { "three": "https://unpkg.com/three@0.157.0/build/three.module.js" } }
  </script>

  <!-- Google APIs (classic scripts) -->
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <script src="https://apis.google.com/js/api.js"></script>

  <!-- App entry (ES Module). -->
  <script type="module" src="./app_boot.js?v=20251004tabs"></script>
</head>
<body>
  <div id="app">
    <div id="stage">
      <div id="spinner">booting…</div>
      <svg id="leader"><line id="leaderLine" x1="0" y1="0" x2="0" y2="0" stroke="#ffcc55" stroke-width="2" opacity="0"/></svg>
      <div id="overlay" style="position:absolute;left:12px;bottom:12px;max-width:min(420px,70vw);background:rgba(12,12,16,.84);backdrop-filter:blur(6px);border:1px solid #333;border-radius:.75rem;padding:.75rem;display:none;cursor:move"></div>
    </div>
    <aside id="panel">
      <header id="topbar">
        <strong>LociMyu v6.6</strong>
        <div style="flex:1"></div>
        <button id="authChip" class="btn" type="button">Sign in</button>
      </header>

      <div id="tabs">
        <div class="tab active" data-tab="cap">Caption</div>
        <div class="tab" data-tab="mat">Material</div>
        <div class="tab" data-tab="view">View</div>
      </div>

      <div id="pane-cap" class="pane active">
        <div class="row">
          <input id="fileIdInput" placeholder="Drive File ID or URL" style="flex:1;padding:.4rem;background:#0f0f13;border:1px solid #333;border-radius:.4rem;color:#ddd">
          <button id="btnLoad" class="btn" type="button">GLB</button>
        </div>
        <div class="col muted">?id=&lt;fileId&gt; または <b>demo</b> でデモモデル</div>

        <div class="row">
          <label class="muted" style="width:92px">Save data</label>
          <select id="sheetSelect" style="flex:1;padding:.35rem;background:#0f0f13;border:1px solid #333;border-radius:.4rem;color:#ddd"></select>
          <button id="btnNewSheet" class="btn" title="Create new sheet" type="button">+</button>
        </div>

        <div class="row" style="gap:.35rem;align-items:center;margin-top:.25rem">
          <label class="muted" style="width:92px">Pin color</label>
          <div id="pinPalette" class="palette"></div>
          <div id="pinFilterToggles" class="ftoggles" aria-label="Pin visibility"></div>
        </div>

        <div class="col" style="margin:.5rem 0">
          <div class="muted" style="margin:.25rem 0">Caption list</div>
          <div id="capList" style="max-height:180px;overflow:auto;border:1px solid #2a2a33;border-radius:.5rem;background:#1a1a22"></div>
        </div>

        <h3 class="muted">Title / Body</h3>
        <div class="col">
          <input id="capTitle" placeholder="Title" style="padding:.4rem;background:#0f0f13;border:1px solid #333;border-radius:.4rem;color:#ddd">
          <textarea id="capBody" placeholder="Body" rows="3" style="padding:.4rem;background:#0f0f13;border:1px solid #333;border-radius:.4rem;color:#ddd"></textarea>
          <div class="row"><button id="btnAddPin" class="btn" title="Shift+Click in viewportでも追加可" type="button">+ Pin</button><button id="btnRefreshImages" class="btn" type="button">Refresh images</button></div>
          <div class="row"><div class="grid" id="imgGrid" style="width:100%"></div></div>
        </div>
      </div>

      <div id="pane-mat" class="pane">
        <p class="muted">（既存の Material UI をここに残す想定。ファイル未変更）</p>
      </div>

      <div id="pane-view" class="pane">
        <p class="muted">（既存の View UI をここに残す想定。ファイル未変更）</p>
      </div>
    </aside>
  </div>
</body>
</html>
