/* lm.ctx.hotfix.v1 */ (function(){const W=window,KEY='__LM_CTX_LAST__';const HUB=(W.__LM_SHEET_CTX_HUB=W.__LM_SHEET_CTX_HUB||{});let last=HUB[KEY]||null;const same=(a,b)=>!!a&&!!b&&a.spreadsheetId===b.spreadsheetId&&String(a.sheetGid)==String(b.sheetGid);W.addEventListener('lm:sheet-context',(e)=>{const ctx=e?.detail||null;if(!ctx||!ctx.spreadsheetId)return;if(same(last,ctx)){e.stopImmediatePropagation?.();return;}last=ctx;HUB[KEY]=ctx;W.__LM_SHEET_CTX=ctx;},{capture:true});W.__lm_replay_ctx__=()=>{if(!last)return false;W.dispatchEvent(new CustomEvent('lm:sheet-context',{detail:last}));return true;};['lm:auth-ready','lm:mat-ui-ready'].forEach(ev=>{W.addEventListener(ev,()=>W.__lm_replay_ctx__(),{once:false});});console.log('[lm.ctx.hotfix.v1] installed');})();